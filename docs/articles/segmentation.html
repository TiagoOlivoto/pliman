<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pliman">
<title>Image segmentation with pliman â€¢ pliman</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Image segmentation with pliman">
<meta property="og:description" content="pliman">
<meta property="og:image" content="https://tiagoolivoto.github.io/pliman/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VWN5YL53DP"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VWN5YL53DP');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pliman</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/manipulation.html">Image manipulation</a>
    <a class="dropdown-item" href="../articles/segmentation.html">Image segmentation</a>
    <a class="dropdown-item" href="../articles/polygons.html">Polygons</a>
    <a class="dropdown-item" href="../articles/analyze_objects.html">Analyze objects in an image</a>
    <a class="dropdown-item" href="../articles/leaf_area.html">Measure leaf area</a>
    <a class="dropdown-item" href="../articles/phytopatometry.html">Phytopatometry</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <a class="dropdown-item" href="../news/index.html">Package news</a>
    <a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more">More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more">
    <a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    <a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a>
    <a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a>
    <a class="dropdown-item" href="../SUPPORT.html">Support</a>
    <a class="dropdown-item" href="../LICENSE.html">Licence</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto2">
    <span class="fab fa fab fa-researchgate fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TiagoOlivoto">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/tolivoto">
    <span class="fab fa fab fa-twitter fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/">
    <span class="fab fa fab fa-mendeley fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Image segmentation with pliman</h1>
                        <h4 data-toc-skip class="author">Tiago
Olivoto</h4>
            
            <h4 data-toc-skip class="date">2023-09-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/pliman/blob/HEAD/vignettes/segmentation.Rmd" class="external-link"><code>vignettes/segmentation.Rmd</code></a></small>
      <div class="d-none name"><code>segmentation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>Image segmentation is the process of partitioning a digital image
into multiple segments (sets of pixels or image objects). In the context
of plant image analysis, segmentation is used to simplify the
representation of an image into something easier to analyze. For
example, when using <code>count_objects()</code> to count crop grains,
first the grains need to be isolated (segmented) from the background. In
<code>pliman</code> the following functions can be used to segment an
image.</p>
<p>In <code>pliman</code> the following functions can be used to segment
an image.</p>
<ul>
<li>
<code><a href="../reference/image_binary.html">image_binary()</a></code> to produce a binary (black and white)
image</li>
<li>
<code><a href="../reference/image_segment.html">image_segment()</a></code> to produce a segmented image (image
objects and a white background).</li>
<li>
<code><a href="../reference/image_segment.html">image_segment_iter()</a></code> to segment an image
iteratively.</li>
</ul>
<p>Both functions segment the image based on the value of some image
index, which may be one of the RGB bands or any operation with these
bands. Internally, these functions call <code><a href="../reference/image_index.html">image_index()</a></code> to
compute these indexes. The following indexes are currently
available.</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Index</th>
<th>Equation</th>
<th>Band</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>R</td>
<td>R</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>G</td>
<td>G</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>B</td>
<td>B</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>NR</td>
<td>R/(R+G+B)</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>NG</td>
<td>G/(R+G+B)</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>NB</td>
<td>B/(R+G+B)</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>GB</td>
<td>G/B</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>RB</td>
<td>R/B</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>GR</td>
<td>G/R</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>BI</td>
<td>sqrt((R<sup>2+G</sup>2+B^2)/3)</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>BIM</td>
<td>sqrt((R<em>2+G</em>2+B*2)/3)</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>SCI</td>
<td>(R-G)/(R+G)</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>GLI</td>
<td>(2<em>G-R-B)/(2</em>G+R+B)</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>HI</td>
<td>(2*R-G-B)/(G-B)</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>NGRDI</td>
<td>(G-R)/(G+R)</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>NDGBI</td>
<td>(G-B)/(G+B)</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>NDRBI</td>
<td>(R-B)/(R+B)</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>I</td>
<td>R+G+B</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>S</td>
<td>((R+G+B)-3*B)/(R+G+B)</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>VARI</td>
<td>(G-R)/(G+R-B)</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>HUE</td>
<td>atan(2<em>(B-G-R)/30.5</em>(G-R))</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>HUE2</td>
<td>atan(2<em>(R-G-R)/30.5</em>(G-B))</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>BGI</td>
<td>B/G</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>L</td>
<td>R+G+B/3</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>GRAY</td>
<td>0.299<em>R + 0.587</em>G + 0.114*B</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>GLAI</td>
<td>(25*(G-R)/(G+R-B)+1.25)</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>CI</td>
<td>(R-B)/R</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>SHP</td>
<td>2*(R-G-B)/(G-B)</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>RI</td>
<td>R**2/(B*G**3)</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>G-B</td>
<td>G-B</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>G-R</td>
<td>G-R</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>R-G</td>
<td>R-G</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>R-B</td>
<td>R-B</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>B-R</td>
<td>B-R</td>
<td>RGB</td>
</tr>
<tr class="odd">
<td>B-G</td>
<td>B-G</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>DGCI</td>
<td>((h - 60)/60 + (1 - s/100) + (1 - b/100)) / 3</td>
<td>HSB</td>
</tr>
<tr class="odd">
<td>GRAY2</td>
<td>((R<sup>2.2+(1.5<em>G)^2.2+(0.6</em>B)</sup>2.2)/(1+1.5<sup>2.2+0.6</sup>2.2))^1/2.2</td>
<td>RGB</td>
</tr>
<tr class="even">
<td>L*</td>
<td>(0.2126 * R + 0.7152 * G + 0.0722 * B)</td>
<td>CIELab</td>
</tr>
<tr class="odd">
<td>a</td>
<td>0.55<em>( (R - (0.2126 </em> R + 0.7152 * G + 0.0722 * B)) / (1.0 -
0.2126))</td>
<td>CIELab</td>
</tr>
<tr class="even">
<td>b*</td>
<td>0.55<em>( (B - (0.2126 </em> R + 0.7152 * G + 0.0722 * B)) / (1.0 -
0.0722))</td>
<td>CIELab</td>
</tr>
<tr class="odd">
<td>L*-a</td>
<td>((0.2126 * R + 0.7152 * G + 0.0722 * B)) - (0.55<em>( (R - (0.2126
</em> R + 0.7152 * G + 0.0722 * B)) / (1.0 - 0.2126)))</td>
<td>CIELab</td>
</tr>
<tr class="even">
<td>L*-b</td>
<td>((0.2126 * R + 0.7152 * G + 0.0722 * B)) - (0.55<em>( (B - (0.2126
</em> R + 0.7152 * G + 0.0722 * B)) / (1.0 - 0.0722)))</td>
<td>CIELab</td>
</tr>
<tr class="odd">
<td>b*-a</td>
<td>(0.55<em>( (B - (0.2126 </em> R + 0.7152 * G + 0.0722 * B)) / (1.0 -
0.0722))) - (0.55<em>( (R - (0.2126 </em> R + 0.7152 * G + 0.0722 * B))
/ (1.0 - 0.2126)))</td>
<td>CIELab</td>
</tr>
</tbody>
</table>
<p>Here, I use the argument <code>index"</code> to test the segmentation
based on the RGB and their normalized values. Users can also provide
their own index by explicitly providing the formula. e.g.,
<code>index = "R-B"</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman" class="external-link">pliman</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,</span></span>
<span><span class="co">#&gt; which was just loaded, will retire in October 2023.</span></span>
<span><span class="co">#&gt; Please refer to R-spatial evolution reports for details, especially</span></span>
<span><span class="co">#&gt; https://r-spatial.org/r/2023/05/15/evolution4.html.</span></span>
<span><span class="co">#&gt; It may be desirable to make the sf package available;</span></span>
<span><span class="co">#&gt; package maintainers should consider adding sf to Suggests:.</span></span>
<span><span class="co">#&gt; The sp package is now running under evolution status 2</span></span>
<span><span class="co">#&gt;      (status 2 uses the sf package in place of rgdal)</span></span>
<span><span class="co">#&gt; |==========================================================|</span></span>
<span><span class="co">#&gt; | Tools for Plant Image Analysis (pliman 2.0.1)            |</span></span>
<span><span class="co">#&gt; | Author: Tiago Olivoto                                    |</span></span>
<span><span class="co">#&gt; | Type 'citation('pliman')' to know how to cite pliman     |</span></span>
<span><span class="co">#&gt; | Type 'vignette('pliman_start')' for a short tutorial     |</span></span>
<span><span class="co">#&gt; | Visit 'http://bit.ly/pkg_pliman' for a complete tutorial |</span></span>
<span><span class="co">#&gt; |==========================================================|</span></span>
<span><span class="va">soy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utils_image.html">image_pliman</a></span><span class="op">(</span><span class="st">"soybean_touch.jpg"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the indexes</span></span>
<span><span class="co"># Only show the first 16 to reduce the image size</span></span>
<span><span class="va">indexes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/image_index.html">image_index</a></span><span class="op">(</span><span class="va">soy</span>, index <span class="op">=</span> <span class="fu"><a href="../reference/utils_file.html">pliman_indexes</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a raster plot with the RGB values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">indexes</span><span class="op">)</span></span></code></pre></div>
<p><img src="segmentation_files/figure-html/segmentation2-1.png" width="960"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Create a density plot with the RGB values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">indexes</span>, type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="segmentation_files/figure-html/segmentation2-2.png" width="960"></p>
<p>In this example, we can see the distribution of the RGB values (first
row) and the normalized RGB values (second row). The two peaks represent
the grains (smaller peak) and the blue background (larger peak). The
clearer the difference between these peaks, the better will the image
segmentation.</p>
<div class="section level3">
<h3 id="segment-an-image">Segment an image<a class="anchor" aria-label="anchor" href="#segment-an-image"></a>
</h3>
<p>The function <code>image_segmentation()</code> is used to segment
images using image indexes. In this example, I will use the same indexes
computed below to see how the image is segmented. The output of this
function can be used as input in the function
<code><a href="../reference/analyze_objects.html">analyze_objects()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">segmented</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/image_segment.html">image_segment</a></span><span class="op">(</span><span class="va">soy</span>, index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R, G, B, NR, NG, NB"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="segmentation_files/figure-html/segmentation3-1.png" width="960"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">segmented</span><span class="op">$</span><span class="va">NB</span><span class="op">)</span></span></code></pre></div>
<p><img src="segmentation_files/figure-html/segmentation3-2.png" width="960"></p>
<p>It seems that the <code>"NB"</code> index provided better
segmentation. <code>"R"</code> and <code>"NR"</code> resulted in an
inverted segmented image, i.e., the grains were considered as background
and the remaining as â€˜selectedâ€™ image. To circumvent this problem, we
can use the argument <code>invert</code> in those functions.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/image_segment.html">image_segment</a></span><span class="op">(</span><span class="va">soy</span>,</span>
<span>              index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R, NR"</span><span class="op">)</span>,</span>
<span>              invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="segmentation_files/figure-html/segmentation4-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="iterative-segmentation">Iterative segmentation<a class="anchor" aria-label="anchor" href="#iterative-segmentation"></a>
</h3>
<p>The function <code><a href="../reference/image_segment.html">image_segment_iter()</a></code> provides an iterative
image segmentation, returning the proportions of segmented pixels. This
is useful when more than one segmentation procedure is needed. Users can
choose how many segmentation perform, using the argument
<code>nseg</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seg_iter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utils_image.html">image_pliman</a></span><span class="op">(</span><span class="st">"sev_leaf_nb.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="segmentation_files/figure-html/segmentation5-1.png" width="700"></p>
<p>Using a soybean sample leaf (above), I will use the function
<code>image_segment_iter</code> to segment the diseased tissue from
healthy tissue. The aim is to segment the symptoms into two classes,
namely, necrosis (brown areas) and chlorosis (yellow areas), and compute
the percentage of each symptom class.</p>
<p>First, we need to find a suitable index for segmentation.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First segmentation</span></span>
<span><span class="va">seg</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/image_segment.html">image_segment</a></span><span class="op">(</span><span class="va">seg_iter</span>,</span>
<span>                index <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<p><img src="segmentation_files/figure-html/segmentation6-1.png" width="960"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># second segmentation</span></span>
<span><span class="va">seg2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/image_segment.html">image_segment</a></span><span class="op">(</span><span class="va">seg</span><span class="op">$</span><span class="va">VARI</span>,</span>
<span>                index <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<p><img src="segmentation_files/figure-html/segmentation6-2.png" width="960"></p>
<p>Note that the same results can be obtained with
<code><a href="../reference/image_segment.html">image_segment_iter()</a></code> using an iterative section.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Only run iteratively</span></span>
<span><span class="fu"><a href="../reference/image_segment.html">image_segment_iter</a></span><span class="op">(</span><span class="va">seg_iter</span>, nseg <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>The <code>"VARI"</code> seems to be a suitable index to segment
symptoms (necrosis and chlorosis) from healthy tissues. The
<code>"GLI"</code> can be used to segment necrosis from chlorosis.
Knowing this, we can now use <code><a href="../reference/image_segment.html">image_segment_iter()</a></code>
explicitly indicating these indexes, as follows</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/image_segment.html">image_segment_iter</a></span><span class="op">(</span><span class="va">seg_iter</span>,</span>
<span>                   nseg <span class="op">=</span> <span class="fl">2</span>, <span class="co"># two segmentations</span></span>
<span>                   index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VARI"</span>, <span class="st">"GLI"</span><span class="op">)</span>,</span>
<span>                   ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;      image  pixels   percent</span></span>
<span><span class="co">#&gt; 1 original 1317600 100.00000</span></span>
<span><span class="co">#&gt; 2     seg1  397044  30.13388</span></span>
<span><span class="co">#&gt; 3     seg2  102621  25.84625</span></span></code></pre></div>
<p><img src="segmentation_files/figure-html/segmentation8-1.png" width="960"></p>
<p>It can be observed that 30.28% of the original image were
characterized as symptoms (both necrosis and chlorosis). Of out this
(symptomatic area), 25.92% are necrotic areas. So 7.85% of the total
area were considered as necrotic areas (30.288 <span class="math inline">\(\times\)</span> 0.2592 or 103464/1317600 <span class="math inline">\(\times\)</span> 100) and 22.43% (30.28 - 7.85 or
(399075 - 103464) / 1317600 <span class="math inline">\(\times\)</span>
100) were considered as chlorotic areas.</p>
<p>Users can use the argument <code>threshold</code> to controls how
segmentation is made. By default (<code>threshold = "Otsu"</code>), a
threshold value based on Otsuâ€™s method is used to reduce the grayscale
image to a binary image. If a numeric value is informed, this value will
be used as a threshold. Inform any non-numeric value different than
<code>"Otsu"</code> to iteratively chosen the threshold based on a
raster plot showing pixel intensity of the index. For
<code>image_segmentation_iter()</code>, a vector (allows a mixed
(numeric and character) type) with the same length of <code>nseg</code>
can be used.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seg_iter1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/image_segment.html">image_segment_iter</a></span><span class="op">(</span><span class="va">seg_iter</span>,</span>
<span>                     nseg <span class="op">=</span> <span class="fl">2</span>, <span class="co"># two segmentations</span></span>
<span>                     index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VARI"</span>, <span class="st">"GLI"</span><span class="op">)</span>,</span>
<span>                     threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"Otsu"</span><span class="op">)</span>,</span>
<span>                     ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                     plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;      image  pixels   percent</span></span>
<span><span class="co">#&gt; 1 original 1317600 100.00000</span></span>
<span><span class="co">#&gt; 2     seg1  103605   7.86316</span></span>
<span><span class="co">#&gt; 3     seg2   82395  79.52802</span></span>
<span><span class="va">seg_iter2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/image_segment.html">image_segment_iter</a></span><span class="op">(</span><span class="va">seg_iter</span>,</span>
<span>                     nseg <span class="op">=</span> <span class="fl">2</span>, <span class="co"># two segmentations</span></span>
<span>                     index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VARI"</span>, <span class="st">"GLI"</span><span class="op">)</span>,</span>
<span>                     threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"Otsu"</span><span class="op">)</span>,</span>
<span>                     ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                     plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;      image  pixels   percent</span></span>
<span><span class="co">#&gt; 1 original 1317600 100.00000</span></span>
<span><span class="co">#&gt; 2     seg1  321999  24.43830</span></span>
<span><span class="co">#&gt; 3     seg2  101175  31.42091</span></span>
<span></span>
<span><span class="fu"><a href="../reference/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">seg_iter1</span><span class="op">$</span><span class="va">images</span><span class="op">$</span><span class="va">seg1</span>,</span>
<span>              <span class="va">seg_iter2</span><span class="op">$</span><span class="va">images</span><span class="op">$</span><span class="va">seg1</span><span class="op">)</span></span></code></pre></div>
<p><img src="segmentation_files/figure-html/segmentation9-1.png" width="960"></p>
<p>Users can then set the argument <code>threshold</code> for their
specific case, depending on the aims of the segmentation.</p>
</div>
</div>
<div class="section level2">
<h2 id="producing-a-binary-image">Producing a binary image<a class="anchor" aria-label="anchor" href="#producing-a-binary-image"></a>
</h2>
<p>We can also produce a binary image with <code><a href="../reference/image_binary.html">image_binary()</a></code>.
Just for curiosity, we will use the indexes <code>"B"</code> (blue) and
<code>"NB"</code> (normalized blue). By default,
<code><a href="../reference/image_binary.html">image_binary()</a></code> rescales the image to 30% of the size of the
original image to speed up the computation time. Use the argument
<code>resize = FALSE</code> to produce a binary image with the original
size.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">binary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/image_binary.html">image_binary</a></span><span class="op">(</span><span class="va">soy</span><span class="op">)</span></span></code></pre></div>
<p><img src="segmentation_files/figure-html/binary1-1.png" width="960"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># original image size</span></span>
<span><span class="fu"><a href="../reference/image_binary.html">image_binary</a></span><span class="op">(</span><span class="va">soy</span>,</span>
<span>             index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B, NB"</span><span class="op">)</span>,</span>
<span>             resize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="segmentation_files/figure-html/binary1-2.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="a-little-bit-more">
<i class="fas fa-scroll"></i> A little bit more!<a class="anchor" aria-label="anchor" href="#a-little-bit-more"></a>
</h2>
<!-- inicio font awesome -->
<script src="https://kit.fontawesome.com/1f72d6921a.js" crossorigin="anonymous"></script><blockquote>
<p>At <a href="https://tiagoolivoto.github.io/paper_pliman/code.html" class="external-link">this
link</a> you will find more examples on how to use {pliman} to analyze
plant images. Source code and images can be downloaded <a href="https://github.com/TiagoOlivoto/paper_pliman/archive/refs/heads/master.zip" class="external-link">here</a>.
You can also find a talk (Portuguese language) about {pliman} <a href="https://www.youtube.com/watch?v=ElvUVlPocgA" class="external-link">here</a>.
<i class="far fa-lightbulb"></i>Lights,
<i class="fas fa-camera"></i>camera, {pliman}!</p>
</blockquote>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
