<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pliman">
<title>Analyzing objects in an image â€¢ pliman</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing objects in an image">
<meta property="og:description" content="pliman">
<meta property="og:image" content="https://tiagoolivoto.github.io/pliman/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VWN5YL53DP"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VWN5YL53DP');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pliman</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/manipulation.html">Image manipulation</a>
    <a class="dropdown-item" href="../articles/segmentation.html">Image segmentation</a>
    <a class="dropdown-item" href="../articles/polygons.html">Polygons</a>
    <a class="dropdown-item" href="../articles/analyze_objects.html">Analyze objects in an image</a>
    <a class="dropdown-item" href="../articles/leaf_area.html">Measure leaf area</a>
    <a class="dropdown-item" href="../articles/phytopatometry.html">Phytopatometry</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <a class="dropdown-item" href="../news/index.html">Package news</a>
    <a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more">More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more">
    <a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    <a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a>
    <a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a>
    <a class="dropdown-item" href="../SUPPORT.html">Support</a>
    <a class="dropdown-item" href="../LICENSE.html">Licence</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto2">
    <span class="fab fa fab fa-researchgate fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TiagoOlivoto">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/tolivoto">
    <span class="fab fa fab fa-twitter fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/">
    <span class="fab fa fab fa-mendeley fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Analyzing objects in an image</h1>
                        <h4 data-toc-skip class="author">Tiago
Olivoto</h4>
            
            <h4 data-toc-skip class="date">2023-07-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/pliman/blob/HEAD/vignettes/analyze_objects.Rmd" class="external-link"><code>vignettes/analyze_objects.Rmd</code></a></small>
      <div class="d-none name"><code>analyze_objects.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>The function <code><a href="../reference/analyze_objects.html">analyze_objects()</a></code> can be used to count
objects in an image. Let us start with a simple example with the image
<code>object_300dpi.png</code> available on the <a href="https://github.com/TiagoOlivoto/pliman/tree/master/image_examples" class="external-link">GitHub
page</a>. To facilitate the image importation from this folder, a helper
function <code><a href="../reference/utils_image.html">image_pliman()</a></code> is used.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman" class="external-link">pliman</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,</span></span>
<span><span class="co">#&gt; which was just loaded, will retire in October 2023.</span></span>
<span><span class="co">#&gt; Please refer to R-spatial evolution reports for details, especially</span></span>
<span><span class="co">#&gt; https://r-spatial.org/r/2023/05/15/evolution4.html.</span></span>
<span><span class="co">#&gt; It may be desirable to make the sf package available;</span></span>
<span><span class="co">#&gt; package maintainers should consider adding sf to Suggests:.</span></span>
<span><span class="co">#&gt; The sp package is now running under evolution status 2</span></span>
<span><span class="co">#&gt;      (status 2 uses the sf package in place of rgdal)</span></span>
<span><span class="co">#&gt; |==========================================================|</span></span>
<span><span class="co">#&gt; | Tools for Plant Image Analysis (pliman 2.0.0)            |</span></span>
<span><span class="co">#&gt; | Author: Tiago Olivoto                                    |</span></span>
<span><span class="co">#&gt; | Type 'citation('pliman')' to know how to cite pliman     |</span></span>
<span><span class="co">#&gt; | Type 'vignette('pliman_start')' for a short tutorial     |</span></span>
<span><span class="co">#&gt; | Visit 'http://bit.ly/pkg_pliman' for a complete tutorial |</span></span>
<span><span class="co">#&gt; |==========================================================|</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utils_image.html">image_pliman</a></span><span class="op">(</span><span class="st">"objects_300dpi.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/unnamed-chunk-2-1.png" width="960"></p>
<p>The above image was produced with Microsoft PowerPoint. It has a
known resolution of 300 dpi (dots per inch) and shows four objects</p>
<ul>
<li>Larger square: 10 x 10 cm (100 cm<sup>2</sup>)</li>
<li>Smaller square: 5 x 5 cm (25 cm<sup>2</sup>)</li>
<li>Rectangle: 4 x 2 cm (8 cm<sup>2</sup>)</li>
<li>Circle: 3 cm in diameter (~7.08 cm<sup>2</sup>)</li>
</ul>
<p>To count the objects in the image we use
<code><a href="../reference/analyze_objects.html">analyze_objects()</a></code> and inform the image object (the only
mandatory argument). First, we use <code><a href="../reference/image_binary.html">image_binary()</a></code> to see
the most suitable index to segment the objects from the background. By
default, the R, G, B (first row) and their normalized values (second
row) are used.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/image_binary.html">image_binary</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/unnamed-chunk-3-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="analyzing-objects">Analyzing objects<a class="anchor" aria-label="anchor" href="#analyzing-objects"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">img_res</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">img</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                  index <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span> <span class="co"># use blue index to segment</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/unnamed-chunk-4-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="adjusting-object-measures">Adjusting object measures<a class="anchor" aria-label="anchor" href="#adjusting-object-measures"></a>
</h2>
<p>The results were stored in <code>img_res</code>. Since there is no
scale declared in the above example, we have no idea about the actual
area of the objects in cm<sup>2</sup>, only in pixels. In this case, we
use <code><a href="../reference/utils_measures.html">get_measures()</a></code> to adjust the measures from pixels to
metric units.</p>
<p>There are two main ways of adjusting the object measures (from pixels
to cm, for example). The first one is to declare the known area,
perimeter, or radius of a given object. The measure for the other
objects will be then computed by a simple rule of three. The second one
is by declaring a known image resolution in dpi (dots per inch). In this
case, the perimeter, area, and radius will be adjusted by the informed
dpi.</p>
<div class="section level3">
<h3 id="declaring-a-known-value">Declaring a known value<a class="anchor" aria-label="anchor" href="#declaring-a-known-value"></a>
</h3>
<p>Since we have known the area of the larger square (object 1), let us
adjust the area of the other objects in the image using that.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">img_res</span>,</span>
<span>             id <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             <span class="va">area</span> <span class="op">~</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; measures corrected with:</span></span>
<span><span class="co">#&gt; object id: 1</span></span>
<span><span class="co">#&gt; area     : 100</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; Total    : 40.001 </span></span>
<span><span class="co">#&gt; Average  : 13.334 </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; Classes 'measures' and 'data.frame': 3 obs. of  34 variables:</span></span>
<span><span class="co">#&gt;  $ id                  : num  2 3 4</span></span>
<span><span class="co">#&gt;  $ x                   : num  1737 1737 1736</span></span>
<span><span class="co">#&gt;  $ y                   : num  452 1295 938</span></span>
<span><span class="co">#&gt;  $ area                : num  25 7.05 7.95</span></span>
<span><span class="co">#&gt;  $ area_ch             : num  24.92 7.05 7.9</span></span>
<span><span class="co">#&gt;  $ perimeter           : num  19.9 10.1 11.9</span></span>
<span><span class="co">#&gt;  $ radius_mean         : num  2.86 1.49 1.67</span></span>
<span><span class="co">#&gt;  $ radius_min          : num  2.492 1.482 0.988</span></span>
<span><span class="co">#&gt;  $ radius_max          : num  3.53 1.51 2.23</span></span>
<span><span class="co">#&gt;  $ radius_sd           : num  0.31434 0.00396 0.42388</span></span>
<span><span class="co">#&gt;  $ diam_mean           : num  5.73 2.99 3.34</span></span>
<span><span class="co">#&gt;  $ diam_min            : num  4.98 2.96 1.98</span></span>
<span><span class="co">#&gt;  $ diam_max            : num  7.06 3.02 4.45</span></span>
<span><span class="co">#&gt;  $ major_axis          : num  2.04 1.06 1.48</span></span>
<span><span class="co">#&gt;  $ minor_axis          : num  2.036 1.053 0.874</span></span>
<span><span class="co">#&gt;  $ caliper             : num  7.01 3 4.43</span></span>
<span><span class="co">#&gt;  $ length              : num  5 3 3.99</span></span>
<span><span class="co">#&gt;  $ width               : num  4.99 3 1.98</span></span>
<span><span class="co">#&gt;  $ radius_ratio        : num  1.42 1.02 2.25</span></span>
<span><span class="co">#&gt;  $ theta               : num  -1.57 0.459 0</span></span>
<span><span class="co">#&gt;  $ eccentricity        : num  0.0505 0.1114 0.808</span></span>
<span><span class="co">#&gt;  $ form_factor         : num  0.79 0.873 0.704</span></span>
<span><span class="co">#&gt;  $ narrow_factor       : num  1.4 1 1.11</span></span>
<span><span class="co">#&gt;  $ asp_ratio           : num  1 1 2.01</span></span>
<span><span class="co">#&gt;  $ rectangularity      : num  0.998 1.278 0.994</span></span>
<span><span class="co">#&gt;  $ pd_ratio            : num  2.85 3.36 2.69</span></span>
<span><span class="co">#&gt;  $ plw_ratio           : num  2 1.68 2</span></span>
<span><span class="co">#&gt;  $ solidity            : num  1 1 1.01</span></span>
<span><span class="co">#&gt;  $ convexity           : num  0.75 0.909 0.836</span></span>
<span><span class="co">#&gt;  $ elongation          : num  0.00169 0.00113 0.50318</span></span>
<span><span class="co">#&gt;  $ circularity         : num  15.9 14.4 17.8</span></span>
<span><span class="co">#&gt;  $ circularity_haralick: num  9.11 377.4 3.94</span></span>
<span><span class="co">#&gt;  $ circularity_norm    : num  0.787 0.868 0.7</span></span>
<span><span class="co">#&gt;  $ coverage            : num  0.1068 0.0301 0.034</span></span></code></pre></div>
<p>The same can be used to adjust the measures based on the perimeter or
radius. Let us adjust the perimeter of objects by the perimeter of
object 2 (20 cm).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">img_res</span>,</span>
<span>             id <span class="op">=</span> <span class="fl">2</span>,</span>
<span>             <span class="va">perimeter</span> <span class="op">~</span> <span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; measures corrected with:</span></span>
<span><span class="co">#&gt; object id: 2</span></span>
<span><span class="co">#&gt; perimeter     : 20</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; Total    : 62.081 </span></span>
<span><span class="co">#&gt; Average  : 20.694 </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; Classes 'measures' and 'data.frame': 3 obs. of  34 variables:</span></span>
<span><span class="co">#&gt;  $ id                  : num  1 3 4</span></span>
<span><span class="co">#&gt;  $ x                   : num  668 1737 1736</span></span>
<span><span class="co">#&gt;  $ y                   : num  797 1295 938</span></span>
<span><span class="co">#&gt;  $ area                : num  100.52 7.09 7.99</span></span>
<span><span class="co">#&gt;  $ area_ch             : num  100.35 7.09 7.94</span></span>
<span><span class="co">#&gt;  $ perimeter           : num  40 10.1 11.9</span></span>
<span><span class="co">#&gt;  $ radius_mean         : num  5.75 1.5 1.67</span></span>
<span><span class="co">#&gt;  $ radius_min          : num  5.01 1.49 0.99</span></span>
<span><span class="co">#&gt;  $ radius_max          : num  7.08 1.51 2.23</span></span>
<span><span class="co">#&gt;  $ radius_sd           : num  0.63056 0.00397 0.42499</span></span>
<span><span class="co">#&gt;  $ diam_mean           : num  11.5 3 3.35</span></span>
<span><span class="co">#&gt;  $ diam_min            : num  10.02 2.97 1.98</span></span>
<span><span class="co">#&gt;  $ diam_max            : num  14.16 3.03 4.46</span></span>
<span><span class="co">#&gt;  $ major_axis          : num  4.09 1.06 1.49</span></span>
<span><span class="co">#&gt;  $ minor_axis          : num  4.088 1.056 0.876</span></span>
<span><span class="co">#&gt;  $ caliper             : num  14.08 3.01 4.45</span></span>
<span><span class="co">#&gt;  $ length              : num  14.16 3.01 4</span></span>
<span><span class="co">#&gt;  $ width               : num  14.15 3.01 1.99</span></span>
<span><span class="co">#&gt;  $ radius_ratio        : num  1.41 1.02 2.25</span></span>
<span><span class="co">#&gt;  $ theta               : num  0.783 0.459 0</span></span>
<span><span class="co">#&gt;  $ eccentricity        : num  0.0253 0.1114 0.808</span></span>
<span><span class="co">#&gt;  $ form_factor         : num  0.788 0.873 0.704</span></span>
<span><span class="co">#&gt;  $ narrow_factor       : num  0.995 1 1.112</span></span>
<span><span class="co">#&gt;  $ asp_ratio           : num  1 1 2.01</span></span>
<span><span class="co">#&gt;  $ rectangularity      : num  1.992 1.278 0.994</span></span>
<span><span class="co">#&gt;  $ pd_ratio            : num  2.84 3.36 2.69</span></span>
<span><span class="co">#&gt;  $ plw_ratio           : num  1.41 1.68 2</span></span>
<span><span class="co">#&gt;  $ solidity            : num  1 1 1.01</span></span>
<span><span class="co">#&gt;  $ convexity           : num  0.75 0.909 0.836</span></span>
<span><span class="co">#&gt;  $ elongation          : num  0.00043 0.00113 0.50318</span></span>
<span><span class="co">#&gt;  $ circularity         : num  15.9 14.4 17.8</span></span>
<span><span class="co">#&gt;  $ circularity_haralick: num  9.12 377.4 3.94</span></span>
<span><span class="co">#&gt;  $ circularity_norm    : num  0.787 0.868 0.7</span></span>
<span><span class="co">#&gt;  $ coverage            : num  0.4274 0.0301 0.034</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="declaring-the-image-resolution">Declaring the image resolution<a class="anchor" aria-label="anchor" href="#declaring-the-image-resolution"></a>
</h3>
<p>If the image resolution is known, all the measures will be adjusted
according to this resolution. Let us to see a numerical example with
<code><a href="../reference/utils_dpi.html">pixels_to_cm()</a></code>. This function converts the number of pixels
(<span class="math inline">\(px\)</span>) to cm, considering the image
resolution in <span class="math inline">\(dpi\)</span>, as follows:
<span class="math inline">\(cm = px \times (2.54/dpi)\)</span>. Since we
know the number of pixels of the larger square, its perimeter in cm is
given by</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># number of pixels for the highest square perimeter</span></span>
<span><span class="va">ls_px</span> <span class="op">&lt;-</span> <span class="va">img_res</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">perimeter</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/utils_dpi.html">pixels_to_cm</a></span><span class="op">(</span>px <span class="op">=</span> <span class="va">ls_px</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 39.9294</span></span></code></pre></div>
<p>The perimeter of object 1 adjusted by the image resolution is very
close to the true (40 cm). Bellow, the values of all measures are
adjusted by declaring the <code>dpi</code> argument in
<code><a href="../reference/utils_measures.html">get_measures()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">img_res</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classes 'measures' and 'data.frame': 4 obs. of  34 variables:</span></span>
<span><span class="co">#&gt;  $ id                  : num  1 2 3 4</span></span>
<span><span class="co">#&gt;  $ x                   : num  668 1737 1737 1736</span></span>
<span><span class="co">#&gt;  $ y                   : num  797 452 1295 938</span></span>
<span><span class="co">#&gt;  $ area                : num  99.98 25 7.05 7.95</span></span>
<span><span class="co">#&gt;  $ area_ch             : num  99.81 24.91 7.05 7.9</span></span>
<span><span class="co">#&gt;  $ perimeter           : num  39.9 19.9 10.1 11.9</span></span>
<span><span class="co">#&gt;  $ radius_mean         : num  5.73 2.86 1.49 1.67</span></span>
<span><span class="co">#&gt;  $ radius_min          : num  4.994 2.491 1.482 0.988</span></span>
<span><span class="co">#&gt;  $ radius_max          : num  7.06 3.53 1.51 2.23</span></span>
<span><span class="co">#&gt;  $ radius_sd           : num  0.62885 0.31432 0.00396 0.42384</span></span>
<span><span class="co">#&gt;  $ diam_mean           : num  11.46 5.73 2.99 3.34</span></span>
<span><span class="co">#&gt;  $ diam_min            : num  9.99 4.98 2.96 1.98</span></span>
<span><span class="co">#&gt;  $ diam_max            : num  14.12 7.06 3.02 4.45</span></span>
<span><span class="co">#&gt;  $ major_axis          : num  4.08 2.04 1.06 1.48</span></span>
<span><span class="co">#&gt;  $ minor_axis          : num  4.077 2.036 1.053 0.874</span></span>
<span><span class="co">#&gt;  $ caliper             : num  14.05 7.01 3 4.43</span></span>
<span><span class="co">#&gt;  $ length              : num  14.12 5 3 3.99</span></span>
<span><span class="co">#&gt;  $ width               : num  14.11 4.99 3 1.98</span></span>
<span><span class="co">#&gt;  $ radius_ratio        : num  1.41 1.42 1.02 2.25</span></span>
<span><span class="co">#&gt;  $ theta               : num  0.783 -1.57 0.459 0</span></span>
<span><span class="co">#&gt;  $ eccentricity        : num  0.0253 0.0505 0.1114 0.808</span></span>
<span><span class="co">#&gt;  $ form_factor         : num  0.788 0.79 0.873 0.704</span></span>
<span><span class="co">#&gt;  $ narrow_factor       : num  0.995 1.402 1 1.112</span></span>
<span><span class="co">#&gt;  $ asp_ratio           : num  1 1 1 2.01</span></span>
<span><span class="co">#&gt;  $ rectangularity      : num  1.992 0.998 1.278 0.994</span></span>
<span><span class="co">#&gt;  $ pd_ratio            : num  2.84 2.85 3.36 2.69</span></span>
<span><span class="co">#&gt;  $ plw_ratio           : num  1.41 2 1.68 2</span></span>
<span><span class="co">#&gt;  $ solidity            : num  1 1 1 1.01</span></span>
<span><span class="co">#&gt;  $ convexity           : num  0.75 0.75 0.909 0.836</span></span>
<span><span class="co">#&gt;  $ elongation          : num  0.00043 0.00169 0.00113 0.50318</span></span>
<span><span class="co">#&gt;  $ circularity         : num  15.9 15.9 14.4 17.8</span></span>
<span><span class="co">#&gt;  $ circularity_haralick: num  9.12 9.11 377.4 3.94</span></span>
<span><span class="co">#&gt;  $ circularity_norm    : num  0.787 0.787 0.868 0.7</span></span>
<span><span class="co">#&gt;  $ coverage            : num  0.4274 0.1068 0.0301 0.034</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="counting-crop-grains">Counting crop grains<a class="anchor" aria-label="anchor" href="#counting-crop-grains"></a>
</h2>
<p>Here, we will count the grains in the image
<code>soybean_touch.jpg</code>. This image has a cyan background and
contains 30 soybean grains that touch with each other. Two segmentation
strategies are used. The first one is by using is image segmentation
based on color indexes.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">soy</span> <span class="op">&lt;-</span>        <span class="fu"><a href="../reference/utils_image.html">image_pliman</a></span><span class="op">(</span><span class="st">"soybean_touch.jpg"</span><span class="op">)</span></span>
<span><span class="va">grain</span> <span class="op">&lt;-</span>      <span class="fu"><a href="../reference/utils_image.html">image_pliman</a></span><span class="op">(</span><span class="st">"soybean_grain.jpg"</span><span class="op">)</span></span>
<span><span class="va">background</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utils_image.html">image_pliman</a></span><span class="op">(</span><span class="st">"la_back.jpg"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">soy</span>, <span class="va">grain</span>, <span class="va">background</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/unnamed-chunk-9-1.png" width="960"></p>
<p>The function <code><a href="../reference/analyze_objects.html">analyze_objects()</a></code> segment the image using
as default the normalized blue index, as follows <span class="math inline">\(NB = (B/(R+G+B))\)</span>, where <span class="math inline">\(R\)</span>, <span class="math inline">\(G\)</span>, and <span class="math inline">\(B\)</span> are the red, green, and blue bands.
Objects are count and the segmented objects are colored with random
permutations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">soy</span>,</span>
<span>                  index <span class="op">=</span> <span class="st">"NB"</span><span class="op">)</span> <span class="co"># default</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/unnamed-chunk-10-1.png" width="960"></p>
<p>Users can set <code>show_contour = FALSE</code> to remove the contour
line and identify the objects (in this example the grains) by using the
arguments <code>marker = "id"</code>. The color of the background can
also be changed with <code>col_background</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">soy</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                  show_segmentation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                  index <span class="op">=</span> <span class="st">"NB"</span><span class="op">)</span> <span class="co"># default</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/unnamed-chunk-11-1.png" width="960"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the object measures</span></span>
<span><span class="va">measures</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">measures</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classes 'measures' and 'data.frame': 30 obs. of  34 variables:</span></span>
<span><span class="co">#&gt;  $ id                  : num  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ x                   : num  245 537 237 344 277 ...</span></span>
<span><span class="co">#&gt;  $ y                   : num  509 401 339 105 260 ...</span></span>
<span><span class="co">#&gt;  $ area                : num  2279 2289 2310 2436 2159 ...</span></span>
<span><span class="co">#&gt;  $ area_ch             : num  2304 2262 2288 2408 2122 ...</span></span>
<span><span class="co">#&gt;  $ perimeter           : num  184 178 181 186 172 ...</span></span>
<span><span class="co">#&gt;  $ radius_mean         : num  26.5 26.6 26.7 27.5 25.8 ...</span></span>
<span><span class="co">#&gt;  $ radius_min          : num  23 24.8 24 24.3 24.2 ...</span></span>
<span><span class="co">#&gt;  $ radius_max          : num  29.4 28.7 29.4 30.5 28 ...</span></span>
<span><span class="co">#&gt;  $ radius_sd           : num  1.375 0.966 1.238 1.74 0.801 ...</span></span>
<span><span class="co">#&gt;  $ diam_mean           : num  53 53.1 53.4 54.9 51.5 ...</span></span>
<span><span class="co">#&gt;  $ diam_min            : num  45.9 49.7 48 48.6 48.5 ...</span></span>
<span><span class="co">#&gt;  $ diam_max            : num  58.8 57.4 58.9 61.1 56.1 ...</span></span>
<span><span class="co">#&gt;  $ major_axis          : num  19.3 19.5 19.8 20.8 18.7 ...</span></span>
<span><span class="co">#&gt;  $ minor_axis          : num  18.2 18 17.9 18 17.7 ...</span></span>
<span><span class="co">#&gt;  $ caliper             : num  57.3 56.9 57.7 61 54.4 ...</span></span>
<span><span class="co">#&gt;  $ length              : num  56.6 56.5 57.2 61 54 ...</span></span>
<span><span class="co">#&gt;  $ width               : num  51.5 52.4 52 51 50.5 ...</span></span>
<span><span class="co">#&gt;  $ radius_ratio        : num  1.28 1.16 1.23 1.26 1.16 ...</span></span>
<span><span class="co">#&gt;  $ theta               : num  -0.828 -0.804 -0.637 -0.979 -0.217 ...</span></span>
<span><span class="co">#&gt;  $ eccentricity        : num  0.328 0.387 0.428 0.495 0.325 ...</span></span>
<span><span class="co">#&gt;  $ form_factor         : num  0.85 0.906 0.886 0.889 0.92 ...</span></span>
<span><span class="co">#&gt;  $ narrow_factor       : num  1.01 1.01 1.01 1 1.01 ...</span></span>
<span><span class="co">#&gt;  $ asp_ratio           : num  1.1 1.08 1.1 1.2 1.07 ...</span></span>
<span><span class="co">#&gt;  $ rectangularity      : num  1.28 1.29 1.29 1.28 1.26 ...</span></span>
<span><span class="co">#&gt;  $ pd_ratio            : num  3.2 3.13 3.14 3.04 3.16 ...</span></span>
<span><span class="co">#&gt;  $ plw_ratio           : num  1.7 1.64 1.66 1.66 1.64 ...</span></span>
<span><span class="co">#&gt;  $ solidity            : num  0.989 1.012 1.009 1.012 1.017 ...</span></span>
<span><span class="co">#&gt;  $ convexity           : num  0.887 0.879 0.911 0.919 0.898 ...</span></span>
<span><span class="co">#&gt;  $ elongation          : num  0.089 0.0737 0.0911 0.1639 0.0643 ...</span></span>
<span><span class="co">#&gt;  $ circularity         : num  14.8 13.9 14.2 14.1 13.7 ...</span></span>
<span><span class="co">#&gt;  $ circularity_haralick: num  19.3 27.5 21.6 15.8 32.2 ...</span></span>
<span><span class="co">#&gt;  $ circularity_norm    : num  0.821 0.875 0.855 0.858 0.887 ...</span></span>
<span><span class="co">#&gt;  $ coverage            : num  0.00426 0.00428 0.00432 0.00456 0.00404 0.0043 0.00414 0.00406 0.00432 0.00405 ...</span></span></code></pre></div>
<p>In the following example, we will select objects with an area above
the average of all objects by using <code>lower_size = 2057.36</code>.
Additionally, we will use the argument
<code>show_original = FALSE</code> to show the results as colors
(non-original image).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">soy</span>,</span>
<span>                marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                show_original <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                lower_size <span class="op">=</span> <span class="fl">2057.36</span>,</span>
<span>                index <span class="op">=</span> <span class="st">"NB"</span><span class="op">)</span> <span class="co"># default</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/unnamed-chunk-13-1.png" width="960"></p>
<p>Users can also use the <code>topn_*</code> arguments to select the
top <code>n</code> objects based on either smaller or largest areas.
Letâ€™s see how to point out the 5 grains with the smallest area, showing
the original grains in a blue background. We will also use the argument
<code>index</code> to choose a personalized index to segment the image.
Just for comparison, we will set up explicitly the normalized blue index
by calling <code>index = "B/(R+G+B)"</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">soy</span>,</span>
<span>                marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                topn_lower <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                col_background <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>                index <span class="op">=</span> <span class="st">"B/(R+G+B)"</span><span class="op">)</span> <span class="co"># default</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/unnamed-chunk-14-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="using-sample-palettes">Using sample palettes<a class="anchor" aria-label="anchor" href="#using-sample-palettes"></a>
</h2>
<p>Sometimes it is difficult to choose an image index that segments the
image efficiently (even using <code>index</code> ). In
<code>pliman</code> users have an alternative image segmentation
strategy that is using sample color palettes. In this case, users can
say to <code>analyze_objects</code> which color palettes are to be used
for background and foreground. A generalized linear model (binomial
family) is then used to predict the value of each pixel (background or
foreground). Letâ€™s see how the grains of the above image can be counted
with this strategy.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">soy</span>,</span>
<span>                background <span class="op">=</span> <span class="va">background</span>,</span>
<span>                foreground <span class="op">=</span> <span class="va">grain</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/unnamed-chunk-15-1.png" width="960"></p>
<p>Provided that the images are stored in the current working directory
(or subdirectory), users can count the objects with no need to first
import the image into the R environment. In this case, image names need
to be declared as characters. Assuming that soy, background, and grain
are the images saved into the current working directory, the same result
as above is obtained with</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>img <span class="op">=</span> <span class="st">"soy"</span>,</span>
<span>                background <span class="op">=</span> <span class="st">"background"</span>,</span>
<span>                foreground <span class="op">=</span> <span class="st">"grain"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="leaf-shape">Leaf shape<a class="anchor" aria-label="anchor" href="#leaf-shape"></a>
</h2>
<p>The function <code><a href="../reference/analyze_objects.html">analyze_objects()</a></code> computes a range of
object features that can be used to study leaf shape. As a motivating
example, I will use the image <code>potato_leaves.png</code>, which was
gathered from Gupta et al.Â (2020)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Gupta, S., Rosenthal, D. M., Stinchcombe, J. R., &amp;amp;
Baucom, R. S. (2020). The remarkable morphological diversity of leaf
shape in sweet potato (&lt;em&gt;Ipomoea batatas&lt;/em&gt;): the influence of
genetics, environment, and GÃ—E. &lt;em&gt;New Phytologist&lt;/em&gt;, 225(5),
2183â€“2195. &lt;a href="https://doi.org/10.1111/nph.16286" class="external-link uri"&gt;https://doi.org/10.1111/nph.16286&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">potato</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utils_image.html">image_pliman</a></span><span class="op">(</span><span class="st">"potato_leaves.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pot_meas</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">potato</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                  show_chull <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># shows the convex hull</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/potato-1.png" width="960"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">pot_meas</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 14</span></span>
<span><span class="co">#&gt;  $ results         :'data.frame':    3 obs. of  34 variables:</span></span>
<span><span class="co">#&gt;   ..$ id                  : num [1:3] 1 2 3</span></span>
<span><span class="co">#&gt;   ..$ x                   : num [1:3] 854 197 535</span></span>
<span><span class="co">#&gt;   ..$ y                   : num [1:3] 223 217 240</span></span>
<span><span class="co">#&gt;   ..$ area                : num [1:3] 51398 58909 35177</span></span>
<span><span class="co">#&gt;   ..$ area_ch             : num [1:3] 54600 76590 63138</span></span>
<span><span class="co">#&gt;   ..$ perimeter           : num [1:3] 1012 1255 1528</span></span>
<span><span class="co">#&gt;   ..$ radius_mean         : num [1:3] 131 140 110</span></span>
<span><span class="co">#&gt;   ..$ radius_min          : num [1:3] 92 68.8 37.3</span></span>
<span><span class="co">#&gt;   ..$ radius_max          : num [1:3] 199 193 189</span></span>
<span><span class="co">#&gt;   ..$ radius_sd           : num [1:3] 26.2 28.6 35.6</span></span>
<span><span class="co">#&gt;   ..$ diam_mean           : num [1:3] 263 280 220</span></span>
<span><span class="co">#&gt;   ..$ diam_min            : num [1:3] 184 137.6 74.7</span></span>
<span><span class="co">#&gt;   ..$ diam_max            : num [1:3] 398 385 378</span></span>
<span><span class="co">#&gt;   ..$ major_axis          : num [1:3] 105.4 106.8 83.6</span></span>
<span><span class="co">#&gt;   ..$ minor_axis          : num [1:3] 82.9 95.2 80.1</span></span>
<span><span class="co">#&gt;   ..$ caliper             : num [1:3] 346 350 318</span></span>
<span><span class="co">#&gt;   ..$ length              : num [1:3] 346 330 294</span></span>
<span><span class="co">#&gt;   ..$ width               : num [1:3] 255 331 309</span></span>
<span><span class="co">#&gt;   ..$ radius_ratio        : num [1:3] 2.16 2.8 5.06</span></span>
<span><span class="co">#&gt;   ..$ theta               : num [1:3] 1.432 -0.167 0.505</span></span>
<span><span class="co">#&gt;   ..$ eccentricity        : num [1:3] 0.617 0.454 0.287</span></span>
<span><span class="co">#&gt;   ..$ form_factor         : num [1:3] 0.631 0.47 0.189</span></span>
<span><span class="co">#&gt;   ..$ narrow_factor       : num [1:3] 1 1.06 1.08</span></span>
<span><span class="co">#&gt;   ..$ asp_ratio           : num [1:3] 1.358 0.995 0.95</span></span>
<span><span class="co">#&gt;   ..$ rectangularity      : num [1:3] 1.72 1.85 2.58</span></span>
<span><span class="co">#&gt;   ..$ pd_ratio            : num [1:3] 2.92 3.59 4.81</span></span>
<span><span class="co">#&gt;   ..$ plw_ratio           : num [1:3] 1.68 1.9 2.54</span></span>
<span><span class="co">#&gt;   ..$ solidity            : num [1:3] 0.941 0.769 0.557</span></span>
<span><span class="co">#&gt;   ..$ convexity           : num [1:3] 0.907 0.735 0.557</span></span>
<span><span class="co">#&gt;   ..$ elongation          : num [1:3] 0.2635 -0.0046 -0.0521</span></span>
<span><span class="co">#&gt;   ..$ circularity         : num [1:3] 19.9 26.7 66.4</span></span>
<span><span class="co">#&gt;   ..$ circularity_haralick: num [1:3] 5.02 4.9 3.1</span></span>
<span><span class="co">#&gt;   ..$ circularity_norm    : num [1:3] 0.626 0.466 0.186</span></span>
<span><span class="co">#&gt;   ..$ coverage            : num [1:3] 0.1339 0.1534 0.0916</span></span>
<span><span class="co">#&gt;  $ statistics      :'data.frame':    7 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   ..$ stat : chr [1:7] "n" "min_area" "mean_area" "max_area" ...</span></span>
<span><span class="co">#&gt;   ..$ value: num [1:7] 3 35177 48495 58909 12129 ...</span></span>
<span><span class="co">#&gt;  $ object_rgb      : NULL</span></span>
<span><span class="co">#&gt;  $ object_index    : NULL</span></span>
<span><span class="co">#&gt;  $ efourier        : NULL</span></span>
<span><span class="co">#&gt;  $ efourier_norm   : NULL</span></span>
<span><span class="co">#&gt;  $ efourier_error  : NULL</span></span>
<span><span class="co">#&gt;  $ efourier_power  : NULL</span></span>
<span><span class="co">#&gt;  $ efourier_minharm: NULL</span></span>
<span><span class="co">#&gt;  $ veins           : NULL</span></span>
<span><span class="co">#&gt;  $ angles          : NULL</span></span>
<span><span class="co">#&gt;  $ mask            : NULL</span></span>
<span><span class="co">#&gt;  $ pcv             : NULL</span></span>
<span><span class="co">#&gt;  $ parms           :List of 1</span></span>
<span><span class="co">#&gt;   ..$ index: chr "NB"</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "anal_obj"</span></span></code></pre></div>
<p>Three key measures (in pixel units) are:</p>
<ol style="list-style-type: decimal">
<li>
<code>area</code> the area of the object.</li>
<li>
<code>area_ch</code> the area of the convex hull.</li>
<li>
<code>perimeter</code> the perimeter of the object.</li>
</ol>
<p>Using these measures, circularity and solidity are computed as shown
in (Gupta et al, 2020).</p>
<p><span class="math display">\[ circularity = 4\pi(area /
perimeter^2)\]</span></p>
<p><span class="math display">\[solidity = area / area\_ch\]</span></p>
<p>Circularity is influenced by serrations and lobing. Solidity is
sensitive to leaves with deep lobes, or with a distinct petiole, and can
be used to distinguish leaves lacking such structures. Unlike
circularity, it is not very sensitive to serrations and minor lobings,
since the convex hull remains largely unaffected.</p>
<div class="section level3">
<h3 id="object-contour">Object contour<a class="anchor" aria-label="anchor" href="#object-contour"></a>
</h3>
<p>Users can also obtain the object contour and convex hull as
follows:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cont</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">potato</span>,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">potato</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/utils_polygon_plot.html">plot_contour</a></span><span class="op">(</span><span class="va">cont</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/cont-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="convex-hull">Convex hull<a class="anchor" aria-label="anchor" href="#convex-hull"></a>
</h3>
<p>The function <code><a href="../reference/utils_objects.html">object_contour()</a></code> returns a list with the
coordinate points for each object contour that can be further used to
obtain the convex hull with <code><a href="../reference/utils_polygon.html">conv_hull()</a></code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utils_polygon.html">conv_hull</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">potato</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/utils_polygon_plot.html">plot_contour</a></span><span class="op">(</span><span class="va">conv</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/conv-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="area-of-the-convex-hull">Area of the convex hull<a class="anchor" aria-label="anchor" href="#area-of-the-convex-hull"></a>
</h3>
<p>Then, the area of the convex hull can be obtained with
<code><a href="../reference/utils_polygon.html">poly_area()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">area</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utils_polygon.html">poly_area</a></span><span class="op">(</span><span class="va">conv</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 54600.0 76589.5 63138.0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="leaves-as-base-plot">Leaves as base plot<a class="anchor" aria-label="anchor" href="#leaves-as-base-plot"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a data frame for contour and convex hull</span></span>
<span><span class="va">df_cont</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">cont</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, object <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cont</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_conv</span> <span class="op">&lt;-</span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">conv</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">conv</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, object <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">conv</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># plot the objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html" class="external-link">palette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"green"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">df_cont</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">V1</span>, <span class="va">V2</span>, </span>
<span>          cex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>          col <span class="op">=</span> <span class="va">object</span>,</span>
<span>          xlab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>          ylab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>          axes <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">df_conv</span>, <span class="va">object</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="va">V1</span>, <span class="va">V2</span>, </span>
<span>             col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>             border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">df_conv</span>, <span class="va">object</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="va">V1</span>, <span class="va">V2</span>, </span>
<span>             col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>             border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">df_conv</span>, <span class="va">object</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="va">V1</span>, <span class="va">V2</span>, </span>
<span>             col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>             border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_objects_files/figure-html/maskpoly-1.png" width="768"></p>
<p>Or do the same with <code>ggplot2</code></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_cont</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">V1</span>, <span class="va">V2</span>, group <span class="op">=</span> <span class="va">object</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">object</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_conv</span>,</span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">V1</span>, <span class="va">V2</span>, fill <span class="op">=</span> <span class="va">object</span><span class="op">)</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="batch-processing">Batch processing<a class="anchor" aria-label="anchor" href="#batch-processing"></a>
</h2>
<p>In plant image analysis, frequently it is necessary to process more
than one image. For example, in plant breeding, the number of grains per
plant (e.g., wheat) is frequently used in the indirect selection of
high-yielding plants. In <code>pliman</code>, batch processing can be
done when the user declares the argument <code>pattern</code>.</p>
<p>The following example would be used to count the objects in the
images with a pattern name <code>"trat"</code> (e.g.,
<code>"trat1"</code>, <code>"trat2"</code>, <code>"tratn"</code>) saved
into the subfolder â€œ<code>originals"</code> in the current working
directory. The processed images will be saved into the subfolder
<code>"processed"</code>. The object <code>list_res</code> will be a
list with two objects (<code>results</code> and <code>statistics</code>)
for each image.</p>
<p>To speed up the processing time, especially for a large number of
images, the argument <code>parallel = TRUE</code> can be used. In this
case, the images are processed asynchronously (in parallel) in separate
<code>R</code> sessions running in the background on the same machine.
The number of sections is set up to 50% of available cores. This number
can be controlled explicitly with the argument <code>workers</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_res</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"trat"</span>, <span class="co"># matches the name pattern in 'originals' subfolder</span></span>
<span>                  dir_original <span class="op">=</span> <span class="st">"originals"</span>,</span>
<span>                  dir_processed <span class="op">=</span> <span class="st">"processed"</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># parallel processing</span></span>
<span>                  workers <span class="op">=</span> <span class="fl">8</span>, <span class="co"># 8 multiple sections</span></span>
<span>                  save_image <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-little-bit-more">
<i class="fas fa-scroll"></i> A little bit more!<a class="anchor" aria-label="anchor" href="#a-little-bit-more"></a>
</h2>
<!-- inicio font awesome -->
<script src="https://kit.fontawesome.com/1f72d6921a.js" crossorigin="anonymous"></script><blockquote>
<p>At <a href="https://tiagoolivoto.github.io/paper_pliman/code.html" class="external-link">this
link</a> you will find more examples on how to use {pliman} to analyze
plant images. Source code and images can be downloaded <a href="https://github.com/TiagoOlivoto/paper_pliman/archive/refs/heads/master.zip" class="external-link">here</a>.
You can also find a talk (Portuguese language) about {pliman} <a href="https://www.youtube.com/watch?v=ElvUVlPocgA" class="external-link">here</a>.
<i class="far fa-lightbulb"></i>Lights,
<i class="fas fa-camera"></i>camera, {pliman}!</p>
</blockquote>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
